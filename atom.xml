<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-05-26T07:39:50.641Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>spring-boot-ioc 解析</title>
    <link href="http://yoursite.com/2019/05/22/springBootIOC/"/>
    <id>http://yoursite.com/2019/05/22/springBootIOC/</id>
    <published>2019-05-22T09:37:43.468Z</published>
    <updated>2019-05-26T07:39:50.641Z</updated>
    
    <content type="html"><![CDATA[<p>spring boot ioc 启动调用堆栈</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">inject:<span class="number">177</span>, InjectionMetadata$InjectedElement (org.springframework.beans.factory.annotation)</span><br><span class="line">inject:<span class="number">90</span>, InjectionMetadata (org.springframework.beans.factory.annotation)</span><br><span class="line">postProcessProperties:<span class="number">321</span>, CommonAnnotationBeanPostProcessor (org.springframework.context.annotation)</span><br><span class="line">populateBean:<span class="number">1395</span>, AbstractAutowireCapableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">doCreateBean:<span class="number">592</span>, AbstractAutowireCapableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">createBean:<span class="number">515</span>, AbstractAutowireCapableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">lambda$doGetBean$<span class="number">0</span>:<span class="number">320</span>, AbstractBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">getObject:-<span class="number">1</span>, <span class="number">2018260103</span> (org.springframework.beans.factory.support.AbstractBeanFactory$$Lambda$<span class="number">144</span>)</span><br><span class="line">getSingleton:<span class="number">222</span>, DefaultSingletonBeanRegistry (org.springframework.beans.factory.support)</span><br><span class="line">doGetBean:<span class="number">318</span>, AbstractBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">getBean:<span class="number">199</span>, AbstractBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">resolveCandidate:<span class="number">277</span>, DependencyDescriptor (org.springframework.beans.factory.config)</span><br><span class="line">doResolveDependency:<span class="number">1247</span>, DefaultListableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">resolveDependency:<span class="number">1167</span>, DefaultListableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">inject:<span class="number">593</span>, AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement (org.springframework.beans.factory.annotation)</span><br><span class="line">inject:<span class="number">90</span>, InjectionMetadata (org.springframework.beans.factory.annotation)</span><br><span class="line">postProcessProperties:<span class="number">374</span>, AutowiredAnnotationBeanPostProcessor (org.springframework.beans.factory.annotation)</span><br><span class="line">populateBean:<span class="number">1395</span>, AbstractAutowireCapableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">doCreateBean:<span class="number">592</span>, AbstractAutowireCapableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">createBean:<span class="number">515</span>, AbstractAutowireCapableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">lambda$doGetBean$<span class="number">0</span>:<span class="number">320</span>, AbstractBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">getObject:-<span class="number">1</span>, <span class="number">2018260103</span> (org.springframework.beans.factory.support.AbstractBeanFactory$$Lambda$<span class="number">144</span>)</span><br><span class="line">getSingleton:<span class="number">222</span>, DefaultSingletonBeanRegistry (org.springframework.beans.factory.support)</span><br><span class="line">doGetBean:<span class="number">318</span>, AbstractBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">getBean:<span class="number">199</span>, AbstractBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">preInstantiateSingletons:<span class="number">849</span>, DefaultListableBeanFactory (org.springframework.beans.factory.support)</span><br><span class="line">finishBeanFactoryInitialization:<span class="number">877</span>, AbstractApplicationContext (org.springframework.context.support)</span><br><span class="line">refresh:<span class="number">549</span>, AbstractApplicationContext (org.springframework.context.support)</span><br><span class="line">refresh:<span class="number">142</span>, ServletWebServerApplicationContext (org.springframework.boot.web.servlet.context)</span><br><span class="line">refresh:<span class="number">775</span>, SpringApplication (org.springframework.boot)</span><br><span class="line">refreshContext:<span class="number">397</span>, SpringApplication (org.springframework.boot)</span><br><span class="line">run:<span class="number">316</span>, SpringApplication (org.springframework.boot)</span><br><span class="line">run:<span class="number">1260</span>, SpringApplication (org.springframework.boot)</span><br><span class="line">run:<span class="number">1248</span>, SpringApplication (org.springframework.boot)</span><br><span class="line">main:<span class="number">26</span>, ZhxtApplication (com.zwkj.zhxt)</span><br></pre></td></tr></table></figure><p>AbstractAutowireCapableBeanFactory 320<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">configureBean</span><span class="params">(Object existingBean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">markBeanAsCreated(beanName);</span><br><span class="line">BeanDefinition mbd = getMergedBeanDefinition(beanName);</span><br><span class="line">RootBeanDefinition bd = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (mbd <span class="keyword">instanceof</span> RootBeanDefinition) &#123;</span><br><span class="line">RootBeanDefinition rbd = (RootBeanDefinition) mbd;</span><br><span class="line">bd = (rbd.isPrototype() ? rbd : rbd.cloneBeanDefinition());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (bd == <span class="keyword">null</span>) &#123;</span><br><span class="line">bd = <span class="keyword">new</span> RootBeanDefinition(mbd);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!bd.isPrototype()) &#123;</span><br><span class="line">bd.setScope(BeanDefinition.SCOPE_PROTOTYPE);</span><br><span class="line">bd.allowCaching = ClassUtils.isCacheSafe(ClassUtils.getUserClass(existingBean), getBeanClassLoader());</span><br><span class="line">&#125;</span><br><span class="line">BeanWrapper bw = <span class="keyword">new</span> BeanWrapperImpl(existingBean);</span><br><span class="line">initBeanWrapper(bw);</span><br><span class="line">populateBean(beanName, bd, bw);</span><br><span class="line"><span class="keyword">return</span> initializeBean(beanName, existingBean, bd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>AbstractAutowireCapableBeanFactory 1336 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">PropertyValues pvs = (mbd.hasPropertyValues() ? mbd.getPropertyValues() : <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mbd.getResolvedAutowireMode() == AUTOWIRE_BY_NAME || mbd.getResolvedAutowireMode() == AUTOWIRE_BY_TYPE) &#123;</span><br><span class="line">MutablePropertyValues newPvs = <span class="keyword">new</span> MutablePropertyValues(pvs);</span><br><span class="line"><span class="comment">// Add property values based on autowire by name if applicable.</span></span><br><span class="line"><span class="keyword">if</span> (mbd.getResolvedAutowireMode() == AUTOWIRE_BY_NAME) &#123;</span><br><span class="line">autowireByName(beanName, mbd, bw, newPvs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Add property values based on autowire by type if applicable.</span></span><br><span class="line"><span class="keyword">if</span> (mbd.getResolvedAutowireMode() == AUTOWIRE_BY_TYPE) &#123;</span><br><span class="line">autowireByType(beanName, mbd, bw, newPvs);</span><br><span class="line">&#125;</span><br><span class="line">pvs = newPvs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">boolean</span> hasInstAwareBpps = hasInstantiationAwareBeanPostProcessors();</span><br><span class="line"><span class="keyword">boolean</span> needsDepCheck = (mbd.getDependencyCheck() != AbstractBeanDefinition.DEPENDENCY_CHECK_NONE);</span><br><span class="line"></span><br><span class="line">PropertyDescriptor[] filteredPds = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (hasInstAwareBpps) &#123;</span><br><span class="line"><span class="keyword">if</span> (pvs == <span class="keyword">null</span>) &#123;</span><br><span class="line">pvs = mbd.getPropertyValues();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (BeanPostProcessor bp : getBeanPostProcessors()) &#123;</span><br><span class="line"><span class="keyword">if</span> (bp <span class="keyword">instanceof</span> InstantiationAwareBeanPostProcessor) &#123;</span><br><span class="line">InstantiationAwareBeanPostProcessor ibp = (InstantiationAwareBeanPostProcessor) bp;</span><br><span class="line">PropertyValues pvsToUse = ibp.postProcessProperties(pvs, bw.getWrappedInstance(), beanName);</span><br><span class="line"><span class="keyword">if</span> (pvsToUse == <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (filteredPds == <span class="keyword">null</span>) &#123;</span><br><span class="line">filteredPds = filterPropertyDescriptorsForDependencyCheck(bw, mbd.allowCaching);</span><br><span class="line">&#125;</span><br><span class="line">pvsToUse = ibp.postProcessPropertyValues(pvs, filteredPds, bw.getWrappedInstance(), beanName);</span><br><span class="line"><span class="keyword">if</span> (pvsToUse == <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pvs = pvsToUse;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;spring boot ioc 启动调用堆栈&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;
      
    
    </summary>
    
      <category term="springboot" scheme="http://yoursite.com/categories/springboot/"/>
    
    
      <category term="ioc" scheme="http://yoursite.com/tags/ioc/"/>
    
  </entry>
  
  <entry>
    <title>博客MD模板应用</title>
    <link href="http://yoursite.com/2019/05/14/mavenProfileSpringboot/"/>
    <id>http://yoursite.com/2019/05/14/mavenProfileSpringboot/</id>
    <published>2019-05-14T03:32:57.338Z</published>
    <updated>2019-05-22T09:38:56.919Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 多环境配置文件激活属性---开发、测试、生产</span><br><span class="line">spring.profiles.active=@activatedProperties@</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 测试环境 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>test<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">profiles.active</span>&gt;</span>test<span class="tag">&lt;/<span class="name">profiles.active</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 本地开发环境 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 默认环境为开发环境 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">profiles.active</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">profiles.active</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 打包后的名字(test.war) --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 打包时要把mapper.xml也打进去！ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 资源根目录排除各环境的配置，使用单独的资源目录来指定 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>test/*<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>dev/*<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources/$&#123;profiles.active&#125;<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果先远程部署后本地启动需要先maven install</p><p>mvn clean package -Pdev  -Dmaven.test.skip=true</p><p>java -jar  /xxx/xxx.jar  –spring.profiles.active=dev </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;
      
    
    </summary>
    
      <category term="other" scheme="http://yoursite.com/categories/other/"/>
    
    
      <category term="模板" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>浅谈 sql的几个小技巧</title>
    <link href="http://yoursite.com/2019/05/13/sqlOptimize/"/>
    <id>http://yoursite.com/2019/05/13/sqlOptimize/</id>
    <published>2019-05-13T12:20:20.544Z</published>
    <updated>2019-05-26T07:31:21.690Z</updated>
    
    <content type="html"><![CDATA[<p>本质上来讲 sql优化和数据库优化是两种优化</p><p>数据库优化包含的种类较多 软件优化,硬件优化<br>理论上 单个mysql数据库能够支撑的是每秒2000的并发 极限是5000</p><p>当然本次不说数据库优化 先说sql优化</p><p>sql优化一般是针对单个业务进行优化</p><p>比如秒杀 系统的订单查询 (当然一般用redis 这里只是举个例子)</p><p>或者说是对excel表格进行分析插入数据库</p><p>等等各种各样的业务</p><p>当然一个简单的sql 可能就是这样的 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">WHERE</span> ASSIGNEE_ = <span class="string">'user10'</span></span><br></pre></td></tr></table></figure><p>但在实际业务环境中可能并不是这样</p><p>实际会复杂很多 以及很多条件</p><p>当我们在处理这样的sql的时候 应该怎么去优化以及从哪里入手</p><h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><p>我们大家都是知道索引可以很好的帮我们来提高效率</p><p>但是具体怎么用 以及针对某个业务或者单条sql怎么优化</p><p>再说这些之前我们先针对SQL进行一些常识性优化  比如</p><h2 id="基本优化"><a href="#基本优化" class="headerlink" title="基本优化"></a>基本优化</h2><p><strong>WHERE 子句里面的列尽量被索引</strong></p><p><strong>尽量避免使用 “SELECT *”</strong></p><p><strong>如果用到分页 尽量使用物理分页 并非逻辑分页</strong></p><p><strong>join列尽量使用索引</strong></p><p><strong>order by 使用索引</strong></p><p>等等  </p><p>总之是<strong>为了避免全表扫描做出的各种操作</strong></p><p>大家应该发现索引的使用还是非常频繁的</p><p>那么具体某个sql使用了哪些索引 以及进行了什么处理操作</p><h1 id="EXPLAIN-优化"><a href="#EXPLAIN-优化" class="headerlink" title="EXPLAIN 优化"></a>EXPLAIN 优化</h1><p>我们可以用  EXPLAIN 关键字去查看执行计划</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> professor a</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> sys_attend b</span><br><span class="line"><span class="keyword">WHERE</span> a.id = b.professor_id</span><br><span class="line"><span class="keyword">AND</span> b.<span class="string">`type`</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">AND</span> b.table_id = <span class="number">93353728</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> a.polling_status = <span class="number">1</span></span><br><span class="line"><span class="keyword">AND</span> a.status = <span class="number">1</span></span><br><span class="line"><span class="keyword">AND</span> (a.Member_category = <span class="number">1</span></span><br><span class="line"><span class="keyword">OR</span> a.Member_category = <span class="number">3</span>)</span><br><span class="line"><span class="keyword">AND</span> (organization_category <span class="keyword">IN</span> (<span class="number">4</span>, <span class="number">7</span>)</span><br><span class="line"><span class="keyword">OR</span> organization_categoryvice <span class="keyword">IN</span> (<span class="number">4</span>, <span class="number">7</span>))</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">0</span>, <span class="number">2</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">id</th><th style="text-align:center">select_type</th><th style="text-align:center">table</th><th style="text-align:center">type</th><th style="text-align:center">possible_keys</th><th style="text-align:center">key</th><th style="text-align:center">key_len</th><th style="text-align:center">ref</th><th style="text-align:center">rows</th><th style="text-align:center">Extra </th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">“PRIMARY”</td><td style="text-align:center">“a”</td><td style="text-align:center">“index_merge”</td><td style="text-align:center">“professor_level_index,professor_levelvice_index”</td><td style="text-align:center">“professor_level_index,professor_levelvice_index”</td><td style="text-align:center">“2,2”</td><td style="text-align:center">NULL</td><td style="text-align:center">28</td><td style="text-align:center">“Using sort_union(professor_level_index,professor_levelvice_index);</td><td>Using where”</td><td></td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">“DEPENDENT SUBQUERY”</td><td style="text-align:center">“b”</td><td style="text-align:center">“ALL”</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">85</td><td style="text-align:center">“Using where”</td></tr></tbody></table><p>这张表里大概有这么几个字段</p><ol><li><p>id 执行顺序 可以重复</p><ul><li>id相同则从上往下执行</li><li>id从大到小执行</li></ul></li><li><p>select_type 搜索类型 一共有十一种 具体可以看这篇博客<a href="https://blog.csdn.net/y1193329479/article/details/78821126#27_DEPENDENT_SUBQUERY_134" target="_blank" rel="noopener">SQL_explain操作解释</a> 这里就简单的介绍常见的几种 </p><ul><li><p>第一种也是最常见到的一种 SIMPLE 简单的select查询,查询中不包含子查询或者union;</p></li><li><p>PRIMARY:查询中若包含任何复杂的子查询,最外层查询则被标记; 就是刚刚的优先级最外层则会显示PRIMARY</p></li><li><p>SUBQUERY:在select或者where列表中包含了子查询;</p></li></ul></li></ol><ol start="3"><li><p>type 显示的是访问类型，一般我们优化sql就是着重优化这个 , 是较为重要的一个指标，结果值从好到坏依次是：<br>system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL。 一般来说，得保证查询至少达到range级别，最好能达到ref。 那么怎么能达到这个级别呢 </p><ul><li><p>ref:非唯一性索引扫描,返回匹配某个单独值得所有行,本质上也是一种索引访问,它返回所有匹配某个单独值的行,然而,它可能会找到多个符合条件的行,所以它应该属于查找和扫描的混合体;</p></li><li><p>range:只检索给定范围的行,使用一个索引来选择行,key列显示使用哪个索引,一般就是在你的where语句中出现了between,&lt;,&gt;,in等的查询；这种范围索引扫描比全表扫描要好,因为它只需要开始于索引的某一个点,结束于另一个点,不用扫描全部索引; 之前说的避免全表扫描就是为了这样</p></li></ul></li></ol><ol start="4"><li><p>possible_keys:显示可能会被应用到这张表的索引,一个或者多个;查询涉及到的字段上若存在索引,则该索引将被列出,但不一定被查询实际使用到;</p></li><li><p>key:实际使用到的索引.如果为null,则没有使用索引;查询中若使用了覆盖索引,则该索引仅出现在key列表中;</p></li><li><p>key_len:表示索引中使用的字节数,可通过该列计算查询中使用的索引的长度,在不损失精确性的情况下,长度越短越好; key_len显示的值为索引字段的最大可能长度,并非实际使用长度,即key_len是根据表定义计算而得,不是通过表内检索出的;</p></li><li><p>ref:显示索引的哪一列被使用了,如果可能的话,是一个常数,哪些列或常量别用于查找索引列上的值;</p></li><li><p>rows:根据表统计信息及索引选用情况,大致估算出找到所需的记录所需要读取的行数;</p></li><li><p>Extra:包含不适合在其它列中显示但十分重要的额外信息:</p><ul><li>对于这个消息栏里展示的东西有很多 一般是你的sql违反的数据库相对应的算法,他认为你的不合理</li><li>在这里就不详细解释了 当大家出现后可以百度相对应的信息 <a href="https://blog.csdn.net/poxiaonie/article/details/77757471" target="_blank" rel="noopener">MySQL中explain执行计划中额外信息字段(Extra)详解</a></li></ul></li></ol><p>那么根据这些信息我们可以查到需要优化哪些地方</p><p>说完 explain 我们可以再说说 explain extended + show warnings </p><p>在执行explain extended  之后我们在 show warnings 可以看到在数据库中我们sql的执行方式, 我们可以在这个基础上再次进行优化</p><p>我们可以看到sql的执行方式，对于分析sql还是很有帮助的。</p><p>( 8 ) SELECT ( 9 ) DISTINCT ( 11 ) &lt; Top Num &gt; &lt; select list &gt; </p><p>( 1 ) FROM [ left_table ] </p><p>( 3 ) &lt; join_type &gt; JOIN &lt; right_table &gt; </p><p>( 2 ) ON &lt; join_condition &gt; </p><p>( 4 ) WHERE &lt; where_condition &gt; </p><p>( 5 ) GROUP BY &lt; group_by_list &gt; </p><p>( 6 ) WITH &lt; CUBE | RollUP &gt; </p><p>( 7 ) HAVING &lt; having_condition &gt; </p><p>( 10 ) ORDER BY &lt; order_by_list &gt;</p><p>从优先级我们可以看出为什么order by 排序在 group by 之前不生效了</p><p>之前那条sql之后后数据库warnings的执行方式是下面这样的<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`id`</span> <span class="keyword">AS</span> <span class="string">`id`</span>,</span><br><span class="line">        <span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`name`</span> <span class="keyword">AS</span> <span class="string">`name`</span>,</span><br><span class="line">        <span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`sex`</span> <span class="keyword">AS</span> <span class="string">`sex`</span>,</span><br><span class="line"><span class="keyword">FROM</span> <span class="string">`zwkj_zhxt`</span>.<span class="string">`professor`</span> <span class="string">`a`</span></span><br><span class="line"><span class="keyword">WHERE</span> ((<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`status`</span> = <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">AND</span> (<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`polling_status`</span> = <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">AND</span> (<span class="keyword">not</span>(<span class="keyword">exists</span>(<span class="comment">/* select#2 */</span><span class="keyword">SELECT</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="string">`zwkj_zhxt`</span>.<span class="string">`sys_attend`</span> <span class="string">`b`</span></span><br><span class="line"><span class="keyword">WHERE</span> ((<span class="string">`zwkj_zhxt`</span>.<span class="string">`b`</span>.<span class="string">`table_id`</span> = <span class="number">93353728</span>)</span><br><span class="line">        <span class="keyword">AND</span> (<span class="string">`zwkj_zhxt`</span>.<span class="string">`b`</span>.<span class="string">`sex`</span> = <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">AND</span> (<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`id`</span> = <span class="string">`zwkj_zhxt`</span>.<span class="string">`b`</span>.<span class="string">`professor_id`</span>)))))</span><br><span class="line">        <span class="keyword">AND</span> ((<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`name`</span> = <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">OR</span> (<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`name`</span> = <span class="number">3</span>))</span><br><span class="line">        <span class="keyword">AND</span> ((<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`sex`</span> <span class="keyword">IN</span> (<span class="number">4</span>,<span class="number">7</span>))</span><br><span class="line">        <span class="keyword">OR</span> (<span class="string">`zwkj_zhxt`</span>.<span class="string">`a`</span>.<span class="string">`sex`</span> <span class="keyword">IN</span> (<span class="number">4</span>,<span class="number">7</span>)))) <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">2</span></span><br></pre></td></tr></table></figure></p><p>从上面还可以看出 and 的优先级 总是高于 or </p><p>但有一点需要注意的是 exteneded得到的sql并不是 最终优化执行的sql<br>这一点可以在官方文档中得到确认<a href="https://dev.mysql.com/doc/refman/8.0/en/explain-extended.html" target="_blank" rel="noopener">Extended EXPLAIN Output Format</a></p><p>一般企业数据库的优化 基本上是</p><p>配硬件+差不多的sql优化+分布式+分库分表+读写分离</p><p>等等 反正一系列的操作 基本满足80%的业务场景</p><p>当然我们优化个别业务需要根据实际场景来优化</p><p>如果确实说需要高级别的维护和优化 公司会有相对应的运维或者DB来做不需要开发者担心</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;本质上来讲 sql优化和数据库优化是两种优化&lt;/p&gt;
&lt;p&gt;数据库优化包含的种类较多 软件优化,硬件优化&lt;br&gt;理论上 单个mysql数据库能够支撑的是每秒2000的并发 极限是5000&lt;/p&gt;
&lt;p&gt;当然本次不说数据库优化 先说sql优化&lt;/p&gt;
&lt;p&gt;sql优化一般是针
      
    
    </summary>
    
      <category term="后端" scheme="http://yoursite.com/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
      <category term="sql" scheme="http://yoursite.com/tags/sql/"/>
    
      <category term="优化" scheme="http://yoursite.com/tags/%E4%BC%98%E5%8C%96/"/>
    
      <category term="数据库" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="db" scheme="http://yoursite.com/tags/db/"/>
    
  </entry>
  
  <entry>
    <title>博客MD模板应用</title>
    <link href="http://yoursite.com/2019/05/13/tamplate/"/>
    <id>http://yoursite.com/2019/05/13/tamplate/</id>
    <published>2019-05-13T11:34:29.290Z</published>
    <updated>2019-05-14T02:34:05.408Z</updated>
    
    <content type="html"><![CDATA[<blockquote><h1 id="literal-asterisks-转义"><a href="#literal-asterisks-转义" class="headerlink" title="\literal asterisks\\ 转义"></a>\<em>literal asterisks\\</em> 转义</h1></blockquote><p>*literal asterisks*</p><blockquote><h1 id="MD语法-加粗-加粗"><a href="#MD语法-加粗-加粗" class="headerlink" title="MD语法 加粗 **加粗**"></a>MD语法 加粗 **加粗**</h1></blockquote><p><strong>比较粗</strong></p><blockquote><h1 id="MD语法-斜体-斜体"><a href="#MD语法-斜体-斜体" class="headerlink" title="MD语法 斜体 *斜体*"></a>MD语法 斜体 *斜体*</h1></blockquote><p><em>本来就是斜的</em>  </p><blockquote><h1 id="MD语法-列表1-2-3"><a href="#MD语法-列表1-2-3" class="headerlink" title="MD语法  列表1. 2. 3."></a>MD语法  列表1. 2. 3.</h1></blockquote><ol><li>ni shuo ni shi shui ?</li><li>ni bushi shuo ni me ?</li><li>wo xi huan de shi ni !</li></ol><blockquote><h1 id="MD语法-列表-XXX-XXX-XXX"><a href="#MD语法-列表-XXX-XXX-XXX" class="headerlink" title="MD语法  列表 -XXX -XXX -XXX"></a>MD语法  列表 -XXX -XXX -XXX</h1></blockquote><ul><li>wo bu shi yi ge haoren </li><li>na ni shi shen me ?</li><li>wo shi dog</li></ul><blockquote><h1 id="MD语法-分割线-代表一条分割线"><a href="#MD语法-分割线-代表一条分割线" class="headerlink" title="MD语法 分割线  *** 代表一条分割线"></a>MD语法 分割线  *** 代表一条分割线</h1></blockquote><hr><hr><hr><blockquote><h1 id="MD语法-A标签-A标签显示的名称-链接地址"><a href="#MD语法-A标签-A标签显示的名称-链接地址" class="headerlink" title="MD语法 A标签 [A标签显示的名称](链接地址)"></a>MD语法 A标签 [A标签显示的名称](链接地址)</h1></blockquote><p><a href="http://www.baidu.com" target="_blank" rel="noopener">baidu</a></p><blockquote><h1 id="MD语法-图片-图片说明-图片地址"><a href="#MD语法-图片-图片说明-图片地址" class="headerlink" title="MD语法  图片 ![ 图片说明 ](图片地址)"></a>MD语法  图片 ![ 图片说明 ](图片地址)</h1></blockquote><p><img src="/img/banner.jpg" alt="img"></p><blockquote><h1 id="MD语法-编写代码-三个"><a href="#MD语法-编写代码-三个" class="headerlink" title="MD语法 编写代码 三个 `"></a>MD语法 编写代码 三个 `</h1></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  <span class="title">print</span><span class="params">(<span class="string">'asd'</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">test</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><blockquote><h1 id="MD语法-表格"><a href="#MD语法-表格" class="headerlink" title="MD语法 表格"></a>MD语法 表格</h1></blockquote><table><thead><tr><th style="text-align:center">id</th><th style="text-align:center">select_type</th><th style="text-align:center">table    </th></tr></thead><tbody><tr><td style="text-align:center"> 1</td><td style="text-align:center">“SIMPLE”</td><td style="text-align:center">“professor”    </td></tr><tr><td style="text-align:center"> 2</td><td style="text-align:center">“SIMPLE”</td><td style="text-align:center">“professor”    </td></tr><tr><td style="text-align:center"> 3</td><td style="text-align:center">“SIMPLE”</td><td style="text-align:center">“professor”    </td></tr></tbody></table><blockquote><h1 id="MD语法-标题-一个-号是一级标题-依此类推"><a href="#MD语法-标题-一个-号是一级标题-依此类推" class="headerlink" title="MD语法 标题  一个#号是一级标题 依此类推"></a>MD语法 标题  一个#号是一级标题 依此类推</h1></blockquote><h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;h1 id=&quot;literal-asterisks-转义&quot;&gt;&lt;a href=&quot;#literal-asterisks-转义&quot; class=&quot;headerlink&quot; title=&quot;\literal asterisks\\ 转义&quot;&gt;&lt;/a&gt;\&lt;em&gt;liter
      
    
    </summary>
    
      <category term="other" scheme="http://yoursite.com/categories/other/"/>
    
    
      <category term="模板" scheme="http://yoursite.com/tags/%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>局域网共享文件夹如何换用户名登陆</title>
    <link href="http://yoursite.com/2019/05/05/windows01/"/>
    <id>http://yoursite.com/2019/05/05/windows01/</id>
    <published>2019-05-05T04:36:17.053Z</published>
    <updated>2019-05-07T09:55:03.834Z</updated>
    
    <content type="html"><![CDATA[<p>你在运行里输入CMD<br>在命令提示符中输入：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use * /delete</span><br></pre></td></tr></table></figure></p><p>OR<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use * /del /y</span><br></pre></td></tr></table></figure></p><p>然后它会问你是否要删除网络连接，按Y，回车即可。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;你在运行里输入CMD&lt;br&gt;在命令提示符中输入：&lt;br&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
      <category term="windwos" scheme="http://yoursite.com/categories/windwos/"/>
    
    
      <category term="共享文件夹" scheme="http://yoursite.com/tags/%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9/"/>
    
      <category term="登陆" scheme="http://yoursite.com/tags/%E7%99%BB%E9%99%86/"/>
    
  </entry>
  
</feed>
